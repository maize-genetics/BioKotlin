package biokotlin.seqIO

import io.kotest.core.spec.style.StringSpec
import io.kotest.matchers.shouldBe

class FastaIOTest : StringSpec({

    val fasta = SeqIO("src/test/resources//biokotlin/seqIO/B73_Ref_Subset.fa")

    val seqLengths = mapOf<String, Int>(
            "B73V4_ctg182" to 1278389,
            "B73V4_ctg10" to 992858,
            "B73V4_ctg31" to 846561,
            "B73V4_ctg91" to 795190,
            "B73V4_ctg52" to 756422,
            "B73V4_ctg142" to 739442,
            "B73V4_ctg56" to 695048,
            "B73V4_ctg65" to 666287,
            "B73V4_ctg193" to 526805,
            "B73V4_ctg75" to 516616,
            "B73V4_ctg53" to 458256,
            "B73V4_ctg50" to 381258,
            "B73V4_ctg181" to 351693,
            "B73V4_ctg140" to 344981,
            "B73V4_ctg72" to 342161,
            "B73V4_ctg178" to 340736,
            "B73V4_ctg6" to 255484,
            "B73V4_ctg129" to 254428,
            "B73V4_ctg26" to 215635,
            "B73V4_ctg112" to 139473,
            "B73V4_ctg196" to 138544,
            "B73V4_ctg109" to 134067,
            "B73V4_ctg155" to 128268,
            "B73V4_ctg2729" to 124116,
            "B73V4_ctg60" to 117437,
            "B73V4_ctg9" to 110418,
            "B73V4_ctg30" to 110255,
            "B73V4_ctg85" to 109991,
            "B73V4_ctg33" to 108212,
            "B73V4_ctg111" to 107933,
            "B73V4_ctg170" to 105189,
            "B73V4_ctg98" to 103641,
            "B73V4_ctg102" to 101603,
            "B73V4_ctg44" to 101180,
            "B73V4_ctg49" to 100579,
            "B73V4_ctg11" to 100537,
            "B73V4_ctg84" to 98601,
            "B73V4_ctg183" to 96695,
            "B73V4_ctg123" to 95420,
            "B73V4_ctg239" to 95256,
            "B73V4_ctg16" to 94873,
            "B73V4_ctg233" to 94458,
            "B73V4_ctg92" to 94431,
            "B73V4_ctg78" to 93364,
            "B73V4_ctg62" to 92234,
            "B73V4_ctg38" to 91381,
            "B73V4_ctg122" to 90796,
            "B73V4_ctg97" to 90109,
            "B73V4_ctg20" to 89036,
            "B73V4_ctg100" to 87733,
            "B73V4_ctg77" to 87707,
            "B73V4_ctg134" to 86441,
            "B73V4_ctg128" to 86301,
            "B73V4_ctg179" to 85784,
            "B73V4_ctg229" to 85258,
            "B73V4_ctg104" to 85134,
            "B73V4_ctg14" to 84781,
            "B73V4_ctg40" to 84148,
            "B73V4_ctg132" to 83845,
            "B73V4_ctg73" to 83778,
            "B73V4_ctg133" to 83688,
            "B73V4_ctg103" to 83681,
            "B73V4_ctg107" to 83503,
            "B73V4_ctg82" to 83476,
            "B73V4_ctg5" to 83265,
            "B73V4_ctg51" to 83120,
            "B73V4_ctg253" to 82972,
            "B73V4_ctg89" to 82793,
            "B73V4_ctg203" to 82450,
            "B73V4_ctg54" to 82446,
            "B73V4_ctg188" to 82080,
            "B73V4_ctg74" to 81536,
            "B73V4_ctg247" to 81363,
            "B73V4_ctg81" to 80451,
            "B73V4_ctg180" to 80324,
            "B73V4_ctg222" to 80070,
            "B73V4_ctg125" to 79882,
            "B73V4_ctg117" to 79679,
            "B73V4_ctg137" to 78370,
            "B73V4_ctg23" to 77423,
            "B73V4_ctg159" to 77382,
            "B73V4_ctg71" to 77242,
            "B73V4_ctg19" to 76840,
            "B73V4_ctg101" to 76596,
            "B73V4_ctg245" to 76559,
            "B73V4_ctg61" to 76354,
            "B73V4_ctg95" to 76262,
            "B73V4_ctg213" to 74799,
            "B73V4_ctg35" to 74491,
            "B73V4_ctg214" to 74080,
            "B73V4_ctg206" to 73968,
            "B73V4_ctg130" to 73561,
            "B73V4_ctg79" to 73283,
            "B73V4_ctg201" to 73251,
            "B73V4_ctg231" to 73141,
            "B73V4_ctg148" to 73006,
            "B73V4_ctg48" to 72581,
            "B73V4_ctg171" to 72536,
            "B73V4_ctg191" to 72401,
            "B73V4_ctg115" to 71809,
            "B73V4_ctg7" to 71433,
            "B73V4_ctg189" to 71282,
            "B73V4_ctg13" to 70946,
            "B73V4_ctg18" to 70926,
            "B73V4_ctg17" to 70750,
            "B73V4_ctg147" to 70601,
            "B73V4_ctg24" to 70597,
            "B73V4_ctg36" to 70486,
            "B73V4_ctg235" to 70135,
            "B73V4_ctg146" to 69976,
            "B73V4_ctg66" to 69959,
            "B73V4_ctg254" to 69595,
            "B73V4_ctg175" to 69465,
            "B73V4_ctg152" to 69060,
            "B73V4_ctg114" to 67958,
            "B73V4_ctg165" to 67904,
            "B73V4_ctg42" to 67687,
            "B73V4_ctg83" to 67579,
            "B73V4_ctg208" to 67134,
            "B73V4_ctg145" to 66893,
            "B73V4_ctg41" to 66656,
            "B73V4_ctg173" to 66538,
            "B73V4_ctg164" to 66428,
            "B73V4_ctg29" to 66393,
            "B73V4_ctg4" to 66261,
            "B73V4_ctg174" to 66228,
            "B73V4_ctg192" to 66116,
            "B73V4_ctg248" to 66018,
            "B73V4_ctg28" to 65819,
            "B73V4_ctg21" to 65749,
            "B73V4_ctg230" to 65674,
            "B73V4_ctg46" to 65659,
            "B73V4_ctg153" to 65477,
            "B73V4_ctg80" to 65470,
            "B73V4_ctg58" to 65407,
            "B73V4_ctg69" to 65268,
            "B73V4_ctg225" to 64997,
            "B73V4_ctg8" to 64470,
            "B73V4_ctg186" to 64245,
            "B73V4_ctg151" to 63917,
            "B73V4_ctg121" to 63567,
            "B73V4_ctg141" to 63556,
            "B73V4_ctg63" to 63530,
            "B73V4_ctg223" to 63290,
            "B73V4_ctg250" to 63031,
            "B73V4_ctg113" to 62853,
            "B73V4_ctg57" to 62662,
            "B73V4_ctg118" to 62538,
            "B73V4_ctg220" to 62284,
            "B73V4_ctg105" to 61773,
            "B73V4_ctg216" to 61539,
            "B73V4_ctg219" to 61449,
            "B73V4_ctg238" to 61153,
            "B73V4_ctg210" to 60995,
            "B73V4_ctg67" to 60926,
            "B73V4_ctg156" to 60365,
            "B73V4_ctg199" to 60303,
            "B73V4_ctg68" to 60205,
            "B73V4_ctg2" to 60109,
            "B73V4_ctg136" to 60070,
            "B73V4_ctg3" to 59657,
            "B73V4_ctg190" to 59524,
            "B73V4_ctg176" to 59418,
            "B73V4_ctg166" to 59352,
            "B73V4_ctg217" to 58830,
            "B73V4_ctg149" to 58809,
            "B73V4_ctg93" to 58809,
            "B73V4_ctg88" to 58721,
            "B73V4_ctg154" to 58645,
            "B73V4_ctg209" to 58608,
            "B73V4_ctg195" to 58299,
            "B73V4_ctg110" to 57973,
            "B73V4_ctg108" to 57822,
            "B73V4_ctg87" to 57632,
            "B73V4_ctg45" to 57348,
            "B73V4_ctg106" to 57130,
            "B73V4_ctg135" to 57064,
            "B73V4_ctg185" to 56966,
            "B73V4_ctg242" to 56713,
            "B73V4_ctg139" to 56161,
            "B73V4_ctg215" to 55962,
            "B73V4_ctg120" to 55817,
            "B73V4_ctg157" to 55665,
            "B73V4_ctg211" to 55641,
            "B73V4_ctg94" to 55397,
            "B73V4_ctg224" to 55301,
            "B73V4_ctg15" to 55297,
            "B73V4_ctg205" to 55164,
            "B73V4_ctg168" to 54946,
            "B73V4_ctg70" to 54868,
            "B73V4_ctg32" to 54684,
            "B73V4_ctg200" to 54466,
            "B73V4_ctg236" to 54117,
            "B73V4_ctg59" to 53907,
            "B73V4_ctg167" to 53643,
            "B73V4_ctg226" to 53614,
            "B73V4_ctg144" to 53538,
            "B73V4_ctg218" to 53522,
            "B73V4_ctg202" to 53313,
            "B73V4_ctg252" to 52549,
            "B73V4_ctg232" to 52477,
            "B73V4_ctg90" to 52427,
            "B73V4_ctg241" to 52360,
            "B73V4_ctg184" to 52129,
            "B73V4_ctg143" to 51967,
            "B73V4_ctg64" to 51910,
            "B73V4_ctg251" to 51883,
            "B73V4_ctg243" to 51365,
            "B73V4_ctg163" to 50620,
            "B73V4_ctg1" to 50531,
            "B73V4_ctg161" to 50526,
            "B73V4_ctg244" to 48860,
            "B73V4_ctg37" to 48545,
            "B73V4_ctg158" to 48311,
            "B73V4_ctg86" to 47381,
            "B73V4_ctg169" to 47089,
            "B73V4_ctg246" to 47028,
            "B73V4_ctg255" to 46945,
            "B73V4_ctg127" to 46935,
            "B73V4_ctg207" to 46344,
            "B73V4_ctg198" to 46041,
            "B73V4_ctg43" to 45711,
            "B73V4_ctg197" to 45447,
            "B73V4_ctg240" to 45166,
            "B73V4_ctg221" to 44889,
            "B73V4_ctg124" to 44508,
            "B73V4_ctg96" to 44176,
            "B73V4_ctg119" to 43926,
            "B73V4_ctg212" to 43787,
            "B73V4_ctg172" to 43047,
            "B73V4_ctg177" to 41679,
            "B73V4_ctg25" to 41524,
            "B73V4_ctg194" to 41461,
            "B73V4_ctg227" to 41417,
            "B73V4_ctg162" to 40634,
            "B73V4_ctg138" to 40594,
            "B73V4_ctg131" to 40576,
            "B73V4_ctg34" to 39815,
            "B73V4_ctg99" to 36676,
            "B73V4_ctg234" to 36081,
            "B73V4_ctg12" to 34930,
            "B73V4_ctg47" to 33120,
            "B73V4_ctg160" to 31799,
            "B73V4_ctg249" to 30460,
            "B73V4_ctg39" to 29460,
            "B73V4_ctg204" to 28410,
            "B73V4_ctg22" to 24080,
            "B73V4_ctg228" to 17651,
            "B73V4_ctg27" to 11339,
            "B73V4_ctg116" to 9476,
            "B73V4_ctg126" to 9160,
            "B73V4_ctg237" to 7104,
            "B73V4_ctg187" to 6454,
            "B73V4_ctg76" to 5568,
            "Mt" to 569630,
            "Pt" to 140384
    )

    "iterateFile" {

        var numSeqs = 0
        fasta.forEachIndexed { index, record ->
            numSeqs++
            (record as NucSeqRecord).sequence.len() shouldBe seqLengths[record.id]
        }
        numSeqs shouldBe 256

    }
})